import { filter, map } from 'rxjs/operators';
import { NavParams } from '@ionic/angular';
import { DataService } from './../../services/data.service';
import { Component, OnInit } from '@angular/core';
import { Observable } from 'rxjs';
import { Property } from 'shared';

@Component({
  selector: 'app-user-property-add',
  templateUrl: './user-property-add.component.html',
  styleUrls: ['./user-property-add.component.scss']
})
export class UserPropertyAddComponent implements OnInit {

  properties: Observable<Property[]>;

  constructor(public data: DataService, public navParams: NavParams) { }

  ngOnInit() {
    const userProperties: Property[] = this.navParams.get('userProperties');
    this.properties = this.data.loadProperties()
      .pipe(
        map(properties => properties.filter(property => !userProperties.find(uProp => uProp.id == property.id)))
      );
  }

  addProperty(property: Property) {
    this.navParams.get('controller').dismiss(property, 'add');
  }

}
