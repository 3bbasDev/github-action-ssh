<ion-header>
  <ion-toolbar *ngIf="property | async as p">
    <ion-title>Wiederkehrende Begehung <span *ngIf="property | async as p">in {{p.address}}</span></ion-title>
    <ion-buttons slot="start">
      <ion-back-button [defaultHref]="'/properties/' + p.id"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content padding>
  <ion-grid fixed>
    <ion-row>
      <ion-col size="12">
        <ion-card *ngIf="task | async as i">
          <ion-toolbar>
            <ion-title>Begehung von {{(property | async)?.address}}</ion-title>
            <fiv-buttons *ngIf="task | async as t" slot="end" [count]="0">
                <fiv-button (click)="confirmDeletion(p,t)" [icon]="'md-trash'" [text]="'Wiederkehrende Begehung löschen'"></fiv-button>
              </fiv-buttons>
          </ion-toolbar>
          <ion-card-header *ngIf="users | async as us">
            <ion-card-subtitle *ngIf="(i.userId | userByID : us) as u">Durchzuführen von {{u.firstname}} {{u.lastname}}

              <ng-container *ngIf="(i.auftragGeberId | userByID : us) as a">
                <ng-container *ngIf="i.userId !== i.auftragGeberId">(Erstellt durch {{a.firstname}} {{a.lastname}})
                </ng-container>

              </ng-container>

            </ion-card-subtitle>
          </ion-card-header>
          <ion-card-content>
            <ion-chip color="primary">
              <ion-label>{{i.scheduleOption.name}} ab {{i.startDate}}</ion-label>
            </ion-chip>
            <ion-chip *ngIf="i.lastScheduledDate" color="tertiary">
              <ion-label>Zuletzt erstellt am {{i.lastScheduledDate}}</ion-label>
            </ion-chip>
            <ion-item-group>
              <ion-item-divider>
                <ion-label>Prüfpunkte</ion-label>
              </ion-item-divider>

              <app-task-kriterium [kriterium]="crit" *ngFor="let crit of i?.pruefkriterien">

              </app-task-kriterium>
            </ion-item-group>

          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>