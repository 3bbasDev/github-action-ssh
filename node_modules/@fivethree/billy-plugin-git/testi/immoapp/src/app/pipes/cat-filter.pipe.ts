import { Pipe, PipeTransform } from '@angular/core';
import { Checklist, Category } from 'shared';

@Pipe({
  name: 'catFilter'
})
export class CategoriesFilterPipe implements PipeTransform {

  transform(value: Checklist[], cat: Category): Checklist[] {
    console.log('transform', value, cat);
    if (!cat || !value) {
      return value;
    }
    const ret: Checklist[] = [];
    value.forEach(c => {
      if (c && c.levels) {
        c.levels.forEach(l => {
          if (l && l.kriterien && l.kriterien.some(k => k.category.id === cat.id) && !ret.some(ch => ch.id === c.id)) {
            ret.push(c);
          }
        });
      }
    });

    return ret;
  }

}
